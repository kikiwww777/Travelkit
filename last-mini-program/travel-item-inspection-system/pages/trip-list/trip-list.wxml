<!--pages/trip-list/trip-list.wxml-->
<view class="trip-list-container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <text class="page-title">æˆ‘çš„è¡Œç¨‹</text>
    <button class="create-btn" type="primary" size="mini" bindtap="createTrip">æ–°å»ºè¡Œç¨‹</button>
  </view>

  <!-- ç­›é€‰æ  -->
  <view class="filter-bar">
    <picker 
      class="filter-picker" 
      mode="selector" 
      range="{{statusOptions}}" 
      range-key="label"
      value="{{filterForm.statusIndex}}"
      bindchange="onStatusChange"
    >
      <view class="picker-text">
        {{selectedStatusLabel}}
      </view>
    </picker>
    
    <picker 
      class="filter-picker" 
      mode="selector" 
      range="{{typeOptions}}" 
      range-key="label"
      value="{{filterForm.typeIndex}}"
      bindchange="onTypeChange"
    >
      <view class="picker-text">
        {{selectedTypeLabel}}
      </view>
    </picker>
    
    <input 
      class="filter-input" 
      placeholder="æœç´¢ç›®çš„åœ°" 
      value="{{filterForm.destination}}"
      bindinput="onDestinationInput"
    />
    
    <button class="reset-btn" size="mini" bindtap="resetFilter">é‡ç½®</button>
  </view>

  <!-- è¡Œç¨‹åˆ—è¡¨ -->
  <view class="trip-list">
    <view 
      class="trip-card" 
      wx:for="{{filteredTrips}}" 
      wx:key="id"
    >
      <view class="trip-header">
        <view class="trip-title-section">
          <text class="trip-destination">{{item.destination}}</text>
          <text class="trip-status status-{{item.status}}">{{item.statusText}}</text>
        </view>
        <text class="trip-more" bindtap="deleteTrip" data-id="{{item.id}}">åˆ é™¤</text>
      </view>
      
      <view class="trip-info">
        <text class="info-item">ğŸ“… {{item.startDate}} - {{item.endDate}}</text>
        <text class="info-item">â± {{item.duration}}å¤©</text>
        <text class="info-item">ğŸ‘¥ {{item.travelers}}äºº</text>
        <text class="info-item">ğŸ“ {{item.typeText}}</text>
      </view>
      
      <view class="trip-progress" wx:if="{{item.totalItems && item.totalItems > 0}}">
        <view class="progress-label">
          <text>æŸ¥éªŒè¿›åº¦</text>
          <text>{{item.checkedItems || 0}}/{{item.totalItems}}</text>
        </view>
        <progress 
          class="progress-bar" 
          percent="{{item.progress || 0}}" 
          stroke-width="6"
          activeColor="#409eff"
        />
      </view>
      
      <view class="trip-actions">
        <button 
          class="action-btn" 
          type="primary" 
          size="mini" 
          bindtap="viewTrip" 
          data-id="{{item.id}}"
        >
          æŸ¥çœ‹è¯¦æƒ…
        </button>
        <button 
          class="action-btn" 
          size="mini" 
          bindtap="checkTrip" 
          data-id="{{item.id}}"
          disabled="{{item.status === 'completed' || item.status === 'cancelled'}}"
        >
          å¼€å§‹æŸ¥éªŒ
        </button>
      </view>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{filteredTrips.length === 0 && !loading}}" class="empty-state">
      <text class="empty-text">æš‚æ— è¡Œç¨‹æ•°æ®</text>
      <button class="empty-btn" type="primary" bindtap="createTrip">åˆ›å»ºç¬¬ä¸€ä¸ªè¡Œç¨‹</button>
    </view>
  </view>
</view>

