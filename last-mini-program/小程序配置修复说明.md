# 小程序配置修复说明

## 问题描述

微信小程序报错：`Error: the type of property "xxx" is illegal`

错误原因：
1. 原 `app.json` 启用了 `glass-easel` 渲染层，新版微信小程序对属性类型检查更严格
2. 配置中包含了示例页面（`pages/index`、`pages/logs`），这些页面包含不兼容的属性
3. 缺少必要的 tabBar 配置，导致页面跳转失败

## 修复内容

### 1. 移除 glass-easel 渲染层

**修改前：**
```json
{
  "style": "v2",
  "componentFramework": "glass-easel",
  "sitemapLocation": "sitemap.json",
  "lazyCodeLoading": "requiredComponents"
}
```

**修改后：**
```json
{
  "style": "v2",
  "sitemapLocation": "sitemap.json"
}
```

### 2. 更新页面路由配置

**修改前：**
```json
{
  "pages": [
    "pages/index/index",
    "pages/logs/logs"
  ]
}
```

**修改后：**
```json
{
  "pages": [
    "pages/login/login",
    "pages/register/register",
    "pages/home/home",
    "pages/trip-list/trip-list",
    "pages/trip-create/trip-create",
    "pages/trip-detail/trip-detail",
    "pages/checklist/checklist",
    "pages/check-process/check-process",
    "pages/profile/profile",
    "pages/statistics/statistics"
  ]
}
```

### 3. 添加 tabBar 配置

添加底部导航栏配置：

```json
{
  "tabBar": {
    "color": "#7A7E83",
    "selectedColor": "#667eea",
    "backgroundColor": "#ffffff",
    "borderStyle": "black",
    "list": [
      {
        "pagePath": "pages/home/home",
        "text": "首页"
      },
      {
        "pagePath": "pages/trip-list/trip-list",
        "text": "行程"
      },
      {
        "pagePath": "pages/profile/profile",
        "text": "我的"
      }
    ]
  }
}
```

### 4. 更新 window 配置

更新窗口配置以匹配项目风格：

```json
{
  "window": {
    "navigationBarTitleText": "出行必带",
    "navigationBarBackgroundColor": "#ffffff",
    "navigationBarTextStyle": "black",
    "backgroundColor": "#f5f5f5"
  }
}
```

## 修复后的完整 app.json

```json
{
  "pages": [
    "pages/login/login",
    "pages/register/register",
    "pages/home/home",
    "pages/trip-list/trip-list",
    "pages/trip-create/trip-create",
    "pages/trip-detail/trip-detail",
    "pages/checklist/checklist",
    "pages/check-process/check-process",
    "pages/profile/profile",
    "pages/statistics/statistics"
  ],
  "window": {
    "navigationBarTitleText": "出行必带",
    "navigationBarBackgroundColor": "#ffffff",
    "navigationBarTextStyle": "black",
    "backgroundColor": "#f5f5f5"
  },
  "tabBar": {
    "color": "#7A7E83",
    "selectedColor": "#667eea",
    "backgroundColor": "#ffffff",
    "borderStyle": "black",
    "list": [
      {
        "pagePath": "pages/home/home",
        "text": "首页"
      },
      {
        "pagePath": "pages/trip-list/trip-list",
        "text": "行程"
      },
      {
        "pagePath": "pages/profile/profile",
        "text": "我的"
      }
    ]
  },
  "style": "v2",
  "sitemapLocation": "sitemap.json"
}
```

## 验证步骤

1. 打开微信开发者工具
2. 点击 **编译** 按钮重新编译小程序
3. 检查是否还有 "the type of property is illegal" 错误
4. 测试底部 tabBar 导航是否正常工作
5. 测试页面跳转功能

## 注意事项

1. **登录页面配置**：`pages/login/login` 设置为第一个页面，作为小程序启动入口。如果用户已登录，会自动跳转到 home 页面
2. **不要启用 glass-easel**：该渲染层尚未完全稳定，可能导致兼容性问题
3. **不要保留示例页面**：`pages/index` 和 `pages/logs` 是模板示例，不应在生产环境使用
4. **tabBar 页面顺序**：tabBar 配置的页面应该在 `pages` 数组的前面
5. **图标配置**：当前使用纯文本 tabBar，后续可以添加图标以提升用户体验

## 相关文件

- `app.json` - 小程序配置文件
- `pages/index/` - 示例页面（可删除）
- `pages/logs/` - 示例页面（可删除）
- `pages/home/` - 首页（tabBar 页面）
- `pages/trip-list/` - 行程列表（tabBar 页面）
- `pages/profile/` - 个人中心（tabBar 页面）

## 后续优化建议

1. 为 tabBar 添加图标以提升用户体验
2. 考虑删除 `pages/index` 和 `pages/logs` 示例页面
3. 根据实际需求调整页面顺序
4. 添加小程序网络域名配置说明

